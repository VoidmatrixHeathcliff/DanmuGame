<div align="center">
    <p align="center">
        <img align="center" src="doc/image/bilibili-fill-live.png" alt="logo" width="200">
    </p>
    <h1 align="center">DanmuGame</h1>
    <p align="center">Bilibili ç›´æ’­é—´å¼¹å¹•æ§åˆ¶æ¸¸æˆå¿«é€Ÿå¼€å‘æ¡†æ¶</p>
    <p align="center">
        <a href="https://github.com/VoidmatrixHeathcliff/DanmuGame/stargazers">
            <img src="https://img.shields.io/github/stars/VoidmatrixHeathcliff/DanmuGame.svg?style=flat&labelColor=e49e61">
        </a>
        <a href="https://github.com/VoidmatrixHeathcliff/DanmuGame/network/members">
            <img src="https://img.shields.io/github/forks/VoidmatrixHeathcliff/DanmuGame.svg?&color=green&style=flat-square">
        </a>
        <a href="https://jq.qq.com/?_wv=1027&k=SFCIfMx6" target="_blank">
            <img src="https://img.shields.io/static/v1?label=chatting&message=QQ&color=blue&style=flat-square">
        </a>
        <a href="https://github.com/VoidmatrixHeathcliff/DanmuGame/graphs/contributors" target="_blank">
            <img src="https://img.shields.io/github/contributors/VoidmatrixHeathcliff/DanmuGame">
        </a>
        <a href="https://github.com/VoidmatrixHeathcliff/DanmuGame/issuese" target="_blank">
            <img src="https://img.shields.io/static/v1?label=feedback&message=Issues&color=pink&style=flat-square">
        </a>
        <a href="https://github.com/VoidmatrixHeathcliff/DanmuGame/blob/main/LICENSE" target="_blank">
            <img src="https://img.shields.io/github/license/VoidmatrixHeathcliff/DanmuGame?style=flat-square">
        </a>
       <img src="https://img.shields.io/github/commit-activity/m/VoidmatrixHeathcliff/DanmuGame">
    </p>
    </br>
</div>

> æœ¬é¡¹ç›®åŸºäº [bilibili-live-ws](https://github.com/simon300000/bilibili-live-ws) å¼€å‘ï¼Œåœ¨æ­¤ç‰¹åˆ«æ„Ÿè°¢ä¸ºæœ¬é¡¹ç›®å¼€æ‹“é“è·¯çš„å¤§ä½¬ä»¬ ~

## ç¨‹åºç»“æ„åŠæµç¨‹

![ç¨‹åºç»“æ„åŠæµç¨‹](doc/image/DanmuGame-framework.jpg)

## é¡¹ç›®ä¾èµ–é¡¹

DanmuUtil ç›´æ’­é—´ç›‘å¬ç¨‹åºä¾èµ–äº `bilibili-live-ws` ç­‰åº“ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ `npm install` å®‰è£…ç›¸å…³ä¾èµ–ï¼›åœ¨ Release ç‰ˆæœ¬ä¸­ï¼ŒDanmuUtil ç¨‹åºå·²æ‰“åŒ…ä¸º `.exe` å½¢å¼ï¼Œæ–¹ä¾¿æ—  Node.js ç¯å¢ƒçš„è®¾å¤‡å¼€ç®±å³ç”¨ã€‚

DanmuGame æ¸¸æˆæ¡†æ¶å’Œ VisualDebugTool è°ƒè¯•å™¨é¡¹ç›®æä¾›äº†åŸºäº VisualStudio 2019 çš„ x64 ç‰ˆæœ¬é¡¹ç›®å·¥ç¨‹ï¼Œå¯ä»¥ç›´æ¥æ‹‰å–åˆ°æœ¬åœ°è¿›è¡Œç¼–è¯‘ï¼Œå¦‚éœ€åœ¨å…¶ä»–ç¼–è¯‘å™¨ç¯å¢ƒæˆ–å…¶ä»–å¹³å°ä¸‹ç¼–è¯‘ï¼Œè¯·å…ˆç¼–è¯‘å¹¶é…ç½®å¦‚ä¸‹ä¾èµ–åº“ï¼š
| åº“åç§°                  | ç½‘å€                                                                                     | åè®®                |
|-------------------------|------------------------------------------------------------------------------------------|---------------------|
| **Lua - 5.4.0**         | [http://www.lua.org/](http://www.lua.org/)                                               | MIT                 |
| **SDL - 2.0.14**        | [https://www.libsdl.org/](https://www.libsdl.org/)                                       | zlib license        |
| **SDL_image - 2.0.5**   | [https://www.libsdl.org/projects/SDL_image/](https://www.libsdl.org/projects/SDL_image/) | zlib license        |
| **SDL_gfx - 1.0.4**     | [https://sourceforge.net/projects/sdlgfx/](https://sourceforge.net/projects/sdlgfx/)     | zlib/libpng license |
| **SDL_mixer - 2.0.4**   | [https://www.libsdl.org/projects/SDL_mixer/](https://www.libsdl.org/projects/SDL_mixer/) | zlib license        |
| **SDL_ttf - 2.0.15**    | [https://www.libsdl.org/projects/SDL_ttf/](https://www.libsdl.org/projects/SDL_ttf/)     | zlib license        |
| **cpp-httplib - 0.8.4** | [https://github.com/yhirose/cpp-httplib/](https://github.com/yhirose/cpp-httplib/)       | MIT                 |
| **cJSON - 1.7.14**      | [https://github.com/DaveGamble/cJSON/](https://github.com/DaveGamble/cJSON/)             | MIT                 |
| **imgui - 1.86**        | [https://github.com/ocornut/imgui/](https://github.com/ocornut/imgui/)                   | MIT                 |

## å¿«é€Ÿä¸Šæ‰‹

å‘å¸ƒç‰ˆæœ¬ä¸­æä¾›äº†å¼€ç®±å³ç”¨çš„ç¨‹åºï¼Œé¦–å…ˆåœ¨ `config.json` ä¸­é…ç½®å¥½ç›´æ’­é—´ä¿¡æ¯åŠæ¸¸æˆè®¾ç½®ï¼ˆè¯¦ç»†é…ç½®å†…å®¹è§ç¨åæè¿°ï¼‰ï¼Œç„¶åå¯åŠ¨ DanmuUtil ç¨‹åºï¼Œå½“ç¨‹åºæ˜¾ç¤ºå¦‚ä¸‹å†…å®¹æ—¶è¯æ˜å¯åŠ¨å¹¶è¿æ¥æˆåŠŸï¼š
![å±å¹•æˆªå›¾](doc/image/screenshot.png)

æ¥ä¸‹æ¥å¯åŠ¨ `DanmuGame.exe`ï¼Œç¨‹åºå°†è‡ªåŠ¨åŠ è½½å¹¶æ‰§è¡Œ `GameScript.lua` ä¸­çš„è„šæœ¬å†…å®¹ï¼Œè°ƒæ•´ç›´æ’­ç”»é¢åˆ°æ¸¸æˆçª—å£å³å¯ã€‚

## é…ç½®æ–‡ä»¶ `Config.json` è¯¦è§£
+ `room`ï¼šéœ€è¦ç›‘å¬çš„ç›´æ’­é—´æˆ¿é—´å·ï¼ˆå®Œæ•´æˆ¿é—´å·ï¼ŒéçŸ­æˆ¿é—´å·ï¼‰
+ `port`ï¼šDanmuUtil ç¨‹åºå’Œ DanmuGame æ¸¸æˆæ¡†æ¶åœ¨æœ¬åœ°é€šä¿¡çš„ç«¯å£å·
+ `window-title`ï¼šæ¸¸æˆçª—å£æ ‡é¢˜æ–‡æœ¬
+ `window-size`ï¼šæ¸¸æˆçª—å£å°ºå¯¸
    - `width`ï¼šæ¸¸æˆçª—å£å®½åº¦ï¼ˆå•ä½ï¼šåƒç´ ï¼‰
    - `height`ï¼šæ¸¸æˆçª—å£é«˜åº¦ï¼ˆå•ä½ï¼šåƒç´ ï¼‰
+ `full-screen`ï¼šæ¸¸æˆçª—å£å…¨å±ï¼ˆå°†è¦†ç›–æ¸¸æˆçª—å£å°ºå¯¸è®¾ç½®ï¼‰
+ `max-fps`ï¼šæ¸¸æˆæœ€é«˜å¸§ç‡ï¼Œè®¾ç½®è¿‡å¤§çš„æœ€é«˜å¸§ç‡å¯èƒ½å¯¼è‡´å®é™…å¸§ç‡ä¸ç¨³å®šï¼ˆå»ºè®®åŒºé—´ï¼š60 ~ 144ï¼‰
+ `linear-filtering`ï¼šå¯¹æ¸¸æˆç”»é¢å¼€å¯çº¿æ€§è¿‡æ»¤æŠ—é”¯é½¿ï¼ˆæŸäº›éœ€è¦å¯¹å›¾ç‰‡ç´ æç¼©æ”¾çš„åƒç´ é£æ¸¸æˆå¯èƒ½ä¸é€‚åˆå¼€å¯ï¼‰

## æ¸¸æˆè„šæœ¬ç¼–å†™åŠ API è¯¦è§£

`GameScript.lua` å°†ä½œä¸ºæ¸¸æˆé€»è¾‘çš„å…¥å£è„šæœ¬è¿›è¡ŒåŠ è½½è¿è¡Œï¼Œä½¿ç”¨ `Lua 5.4` ç‰ˆæœ¬è¯­æ³•ç¼–å†™ï¼Œè¯·ç¡®ä¿å·²åœ¨è„šæœ¬ç¯å¢ƒä¸­å£°æ˜ `__EventHandler` å‡½æ•°å’Œ `__MainUpdate` å‡½æ•°ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°ä¼šåˆ†åˆ«åœ¨ **ç›´æ’­é—´äº‹ä»¶æ›´æ–°**ï¼ˆå¦‚å¼¹å¹•å‘é€ï¼‰å’Œ **æ¸¸æˆç”»é¢å¸§æ›´æ–°** æ—¶è¢«è°ƒç”¨ï¼š
+ å¯¹äºå‡½æ•° `__EventHandler(event, data)`ï¼Œç¬¬ä¸€ä¸ªå‚æ•° `event` æ˜¯ä»£è¡¨å½“å‰äº‹ä»¶ç±»å‹çš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°åŒ…å«äº†äº‹ä»¶ç›¸å…³æ•°æ®ï¼Œå¯èƒ½çš„å€¼å¦‚ä¸‹ï¼š
    | å€¼          | äº‹ä»¶         | æ•°æ®                                                 |
    |-------------|--------------|------------------------------------------------------|
    | `"ENTER"`   | è§‚ä¼—è¿›å…¥æˆ¿é—´ | `data.username` è§‚ä¼—æ˜µç§°                             |
    | `"MESSAGE"` | è§‚ä¼—å‘é€å¼¹å¹• | `data.username` è§‚ä¼—æ˜µç§°<br>`data.username` å¼¹å¹•å†…å®¹ |
+ å¯¹äºå‡½æ•° `__MainUpdate()`ï¼Œç¨‹åºä¼šåœ¨æ¯æ¬¡å°è¯•åˆ·æ–°æ¸¸æˆç”»é¢æ—¶è°ƒç”¨æ­¤å‡½æ•°ï¼Œå¯ä»¥åœ¨å‡½æ•°å†…ç¼–å†™æ¸¸æˆç”»é¢æ¸²æŸ“ç›¸å…³çš„é€»è¾‘ï¼›

---

***ä»¥ä¸‹å†…å®¹æ­£åœ¨ç»´æŠ¤ ...***

<details>
    <summary>ğŸ•¹ æ¸¸æˆæ§åˆ¶ç›¸å…³ API</summary>

### QuitGame()
+ **åŠŸèƒ½ï¼š** é€€å‡ºæ¸¸æˆ
+ **å‚æ•°ç®€ä»‹ï¼š** æ— 
+ **è¿”å›å€¼ç®€ä»‹ï¼š** æ— 

</details>

<details>
    <summary>ğŸ–¥ æ¸¸æˆçª—å£ç›¸å…³ API</summary>

| å‡½æ•°å                                                      | ç®€ä»‹                         |
|:------------------------------------------------------------|:-----------------------------|
| [ETHX_InitWindow()](#ETHX_InitWindow)                       | åˆå§‹åŒ– EtherX å¹¶åˆ›å»ºçª—å£     |
| [ETHX_QuitWindow()](#ETHX_QuitWindow)                       | é€€å‡º EtherX å¹¶å…³é—­çª—å£       |
| [ETHX_ShowMessageBox()](#ETHX_ShowMessageBox)               | æ˜¾ç¤ºä¿¡æ¯æç¤ºæ¡†               |
| [ETHX_ShowConfirmMessageBox()](#ETHX_ShowConfirmMessageBox) | æ˜¾ç¤ºä¿¡æ¯æç¤ºç¡®è®¤çª—å£         |
| [ETHX_SetWindowTitle()](#ETHX_SetWindowTitle)               | é‡æ–°è®¾ç½®çª—å£æ ‡é¢˜             |
| [ETHX_GetWindowTitle()](#ETHX_GetWindowTitle)               | è·å–çª—å£æ ‡é¢˜                 |
| [ETHX_SetWindowFullscreen()](#ETHX_SetWindowFullscreen)     | è®¾ç½®çª—å£æ˜¯å¦å…¨å±             |
| [ETHX_SetWindowSize()](#ETHX_SetWindowSize)                 | è®¾ç½®çª—å£å¤§å°                 |
| [ETHX_GetWindowSize()](#ETHX_GetWindowSize)                 | è·å–çª—å£å¤§å°                 |
| [ETHX_GetWindowSize_HDPI()](#ETHX_GetWindowSize_HDPI)       | è·å–é«˜åˆ†è¾¨ç‡ä¸‹çª—å£çš„å®é™…å¤§å° |
| [ETHX_SetWindowIcon()](#ETHX_SetWindowIcon)                 | è®¾ç½®çª—å£å›¾æ ‡                 |
| [ETHX_ClearWindow()](#ETHX_ClearWindow)                     | æ¸…ç©ºçª—å£å†…å®¹                 |
| [ETHX_UpdateWindow()](#ETHX_UpdateWindow)                   | åˆ·æ–°çª—å£                     |

</details>

<details>
    <summary>ğŸ–¼ æ¸¸æˆç”»é¢ç›¸å…³ API</summary>

| å‡½æ•°å                                            | ç®€ä»‹                               |
|:--------------------------------------------------|:-----------------------------------|
| [ETHX_LoadImage()](#ETHX_LoadImage)               | åŠ è½½å›¾åƒå¯¹è±¡                       |
| [ETHX_SetImageColorKey()](#ETHX_SetImageColorKey) | è®¾ç½®å›¾åƒå¯¹è±¡æŒ‡å®šçš„é€æ˜é¢œè‰²æ˜¯å¦å¯ç”¨ |
| [ETHX_SetImageAplha()](#ETHX_SetImageAplha)       | è®¾ç½®å›¾åƒé€æ˜åº¦                     |
| [ETHX_GetImageSize()](#ETHX_GetImageSize)         | è·å–å›¾åƒå°ºå¯¸                       |
| [ETHX_DrawImage()](#ETHX_DrawImage)               | ç»˜åˆ¶å›¾åƒ                           |
| [ETHX_SetDrawColor()](#ETHX_SetDrawColor)         | è®¾ç½®ç»˜å›¾é¢œè‰²                       |
| [ETHX_GetDrawColor()](#ETHX_GetDrawColor)         | è·å–å½“å‰ç»˜å›¾é¢œè‰²                   |
| [ETHX_DrawPoint()](#ETHX_DrawPoint)               | ç»˜åˆ¶ç‚¹                             |
| [ETHX_DrawLine()](#ETHX_DrawLine)                 | ç»˜åˆ¶çº¿æ®µ                           |
| [ETHX_DrawRectangle()](#ETHX_DrawRectangle)       | ç»˜åˆ¶çŸ©å½¢                           |
| [ETHX_DrawCircle()](#ETHX_DrawCircle)             | ç»˜åˆ¶åœ†                             |
| [ETHX_DrawEllipse()](#ETHX_DrawEllipse)           | ç»˜åˆ¶æ¤­åœ†                           |
| [ETHX_DrawPie()](#ETHX_DrawPie)                   | ç»˜åˆ¶æ‰‡å½¢                           |
| [ETHX_DrawTriangle()](#ETHX_DrawTriangle)         | ç»˜åˆ¶ä¸‰è§’å½¢                         |
| [ETHX_LoadFont()](#ETHX_LoadFont)                 | åŠ è½½å­—ä½“å¯¹è±¡                       |
| [ETHX_SetFontStyle()](#ETHX_SetFontStyle)         | è®¾ç½®å­—ä½“æ ·å¼                       |
| [ETHX_GetFontStyle()](#ETHX_GetFontStyle)         | è·å–å­—ä½“æ ·å¼                       |
| [ETHX_GetTextSize()](#ETHX_GetTextSize)           | è·å–æŒ‡å®šå­—ä½“çš„æ–‡æœ¬å°ºå¯¸             |
| [ETHX_DrawText()](#ETHX_DrawText)                 | ç»˜åˆ¶æ–‡æœ¬å†…å®¹                       |
| [ETHX_CreateTextImage()](#ETHX_CreateTextImage)   | åˆ›å»ºæ–‡æœ¬å›¾åƒ                       |

</details>

<details>
    <summary>ğŸ¼ éŸ³ä¹éŸ³æ•ˆç›¸å…³ API</summary>

| å‡½æ•°å                                              | ç®€ä»‹                     |
|:----------------------------------------------------|:-------------------------|
| [ETHX_LoadMusic()](#ETHX_LoadMusic)                 | åŠ è½½éŸ³ä¹å¯¹è±¡             |
| [ETHX_PlayMusic()](#ETHX_PlayMusic)                 | æ’­æ”¾éŸ³ä¹å¯¹è±¡             |
| [ETHX_StopMusic()](#ETHX_StopMusic)                 | æ˜¾åœæ­¢æ­£åœ¨æ’­æ”¾çš„éŸ³ä¹     |
| [ETHX_CheckMusicPlaying()](#ETHX_CheckMusicPlaying) | æ£€æŸ¥éŸ³ä¹æ˜¯å¦æ­£åœ¨æ’­æ”¾     |
| [ETHX_PauseMusic()](#ETHX_PauseMusic)               | æš‚åœæ­£åœ¨æ’­æ”¾çš„éŸ³ä¹       |
| [ETHX_ResumeMusic()](#ETHX_ResumeMusic)             | æ¢å¤æ’­æ”¾æš‚åœçŠ¶æ€çš„éŸ³ä¹   |
| [ETHX_RewindMusic()](#ETHX_RewindMusic)             | å°†å½“å‰éŸ³ä¹é‡æ–°ä»èµ·ç‚¹æ’­æ”¾ |
| [ETHX_SetMusicVolume()](#ETHX_SetMusicVolume)       | è®¾ç½®éŸ³ä¹æ’­æ”¾çš„éŸ³é‡       |
| [ETHX_GetMusicVolume()](#ETHX_GetMusicVolume)       | è·å–éŸ³ä¹æ’­æ”¾çš„éŸ³é‡       |
| [ETHX_LoadSound()](#ETHX_LoadSound)                 | åŠ è½½éŸ³æ•ˆå¯¹è±¡             |
| [ETHX_PlaySound()](#ETHX_PlaySound)                 | æ’­æ”¾éŸ³æ•ˆå¯¹è±¡             |
| [ETHX_SetSoundVolume()](#ETHX_SetSoundVolume)       | è®¾ç½®éŸ³æ•ˆæ’­æ”¾çš„éŸ³é‡       |
| [ETHX_GetSoundVolume()](#ETHX_GetSoundVolume)       | è·å–éŸ³æ•ˆæ’­æ”¾çš„éŸ³é‡       |

</details>

<details>
    <summary>â² æ—¶é—´æ§åˆ¶ç›¸å…³ API</summary>

| å‡½æ•°å                                  | ç®€ä»‹                         |
|:----------------------------------------|:-----------------------------|
| [ETHX_Sleep()](#ETHX_Sleep)             | æš‚åœç¨‹åºæŒ‡å®šæ—¶é•¿             |
| [ETHX_GetInitTime()](#ETHX_GetInitTime) | è·å–ç¨‹åºä»åˆå§‹åŒ–åˆ°ç°åœ¨çš„æ—¶é•¿ |

</details>

<details>
    <summary>ğŸ“Œ æ•°æ®å­˜å‚¨ç›¸å…³ API</summary>

+ [çª—å£åæ ‡ç³»](#window-coordinate-system)
+ [å›¾åƒåæ ‡ç³»](#image-coordinate-system)
+ [å­—ç¬¦ä¸²ç¼–ç ](#string-encoding)

</details>